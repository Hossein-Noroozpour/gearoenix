CMAKE_MINIMUM_REQUIRED (VERSION 3.8 FATAL_ERROR)

ENABLE_TESTING ()

PROJECT (GEAROENIX)

SET (GX_VERSION_MAJOR 0)
SET (GX_VERSION_MINOR 2)

OPTION (GX_USE_SDL2 "Use SDL2 library" ON)
OPTION (GX_USE_OPENGL_ES2 "Activate OpenGL ES 2" ON)
OPTION (GX_USE_OPENGL_ES3 "Activate OpenGL ES 3 (WIP)" OFF)
OPTION (GX_USE_OPENGL_43 "Activate OpenGL 4.3+ (WIP)" OFF)
OPTION (GX_USE_VULKAN "Activate Vulkan (WIP)" OFF)

SET (GX_PATH_SEP "/")
IF (WIN32)
    OPTION (GX_USE_DIRECTX11 "Activate Direct3DX 11 (WIP)" OFF)
    OPTION (GX_USE_DIRECTX12 "Activate Direct3DX 12 (WIP)" OFF)
    SET (GX_PATH_SEP "\\")
ENDIF (WIN32)

FUNCTION (GX_MAKE_LIB GX_CROSS_LIB_FILE GX_LIB_NAME)
    IF (MSVC)
        SET (${GX_CROSS_LIB_FILE} "${GX_LIB_NAME}.lib" PARENT_SCOPE)
    ELSE ()
        SET (${GX_CROSS_LIB_FILE} "lib${GX_LIB_NAME}.a" PARENT_SCOPE)
    ENDIF (MSVC)
ENDFUNCTION (GX_MAKE_LIB)

SET (GX_SDK_PATH "${CMAKE_SOURCE_DIR}${GX_PATH_SEP}sdk${GX_PATH_SEP}")
MESSAGE (STATUS "Gearoenix SDK path is '${GX_SDK_PATH}'.")

SET (DEFAULT_BUILD_TYPE "MinSizeRel")
if (EXISTS "${CMAKE_SOURCE_DIR}/.git")
    SET (DEFAULT_BUILD_TYPE "Debug")
endif ()
 
IF (NOT CMAKE_BUILD_TYPE AND NOT CMAKE_CONFIGURATION_TYPES)
    MESSAGE (STATUS "Setting build type to '${DEFAULT_BUILD_TYPE}' as none was specified.")
    SET (CMAKE_BUILD_TYPE "${DEFAULT_BUILD_TYPE}" CACHE STRING "Choose the type of build." FORCE)
    SET_PROPERTY(CACHE CMAKE_BUILD_TYPE PROPERTY STRINGS "Debug" "Release" "MinSizeRel" "RelWithDebInfo")
ENDIF()

SET (CMAKE_CXX_STANDARD 17)

IF (MSVC)
    SET (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} /std:c++17")
ELSE ()
    SET (CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++17 -Wall")
ENDIF (MSVC)


IF (GX_USE_SDL2)
    SET (GX_SDL2_PATH "${GX_SDK_PATH}${GX_PATH_SEP}SDL2-2.0.9")
    SET (GX_SDL2_STATIC_LIB "SDL2")
    SET (GX_SDL2_MAIN_LIB "SDL2main")
    IF (MSVC)
        SET(GX_SDL2_STATIC_LIB "SDL2-static")
    ENDIF (MSVC)
    GX_MAKE_LIB (GX_SDL2_STATIC_LIB ${GX_SDL2_STATIC_LIB})
    GX_MAKE_LIB (GX_SDL2_MAIN_LIB ${GX_SDL2_MAIN_LIB})
    MESSAGE (STATUS "SDL2 libraries are ${GX_SDL2_STATIC_LIB} and ${GX_SDL2_MAIN_LIB}.")
ENDIF (GX_USE_SDL2)

# ADD_SUBDIRECTORY (examples)
ADD_SUBDIRECTORY (src)
# ADD_SUBDIRECTORY (tests)